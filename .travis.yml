dist: xenial
addons:
  apt:
    sources:
    - sourceline: 'ppa:dns-oarc/dsc-pr'
    update: true
    packages:
    - libpcap-dev
    - libproc-pid-file-perl
    - libgeoip-dev
    - libmaxminddb-dev
    - libdnswire-dev
    - libuv1-dev
language: c
compiler:
  - clang
  - gcc
install: ./autogen.sh
script:
  - ./configure --enable-warn-all --enable-dnstap
  - make dist
  - tar zxvf *.tar.gz
  - cd dsc-*[0-9]
  - mkdir build
  - cd build
  - ../configure --enable-warn-all --enable-dnstap
  - make
  - make test
  - cat src/test/test*.sh.log
